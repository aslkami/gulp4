"use strict";var aptchaChecked="",ischeck=window.localStorage.remember;function aptchaClick(){$(".js-kaptcha").attr("src",API_HOST+"/getKaptcha?d="+1*new Date),aptchaChecked="",$(".login-form .fa-check-circle-o").addClass("hidden"),$(".login-form .fa-times-circle-o").addClass("hidden"),$(".login-form #kaptcha").val("").focus(),$(".login-form .login-btn").addClass("disabled").attr("disabled","disabled")}function checkAptcha(){var o=$("#kaptcha").val().trim();$.ajax({type:"POST",url:"/checkKaptcha?verifyCode="+o,cache:!1,dataType:"json",success:function(e){if(!e.result)return $(".login-form .fa-check-circle-o").addClass("hidden"),void $(".login-form .fa-times-circle-o").removeClass("hidden");$(".login-form .fa-check-circle-o").removeClass("hidden"),$(".login-form .fa-times-circle-o").addClass("hidden"),$(".login-form .login-btn").removeClass("disabled").removeAttr("disabled"),aptchaChecked=o},error:function(){layer.msg("请求失败")}})}function login(){var e=$("#loginForm").serializeObject();return e.username?e.password?e.uservrifyCode?(ischeck&&(window.localStorage.inputPassword=e.password,window.localStorage.remember=!0),window.localStorage.inputUsername=e.username,e.password=$.md5(e.password),void $.ajax({type:"POST",url:"/relogin",data:e,dataType:"json",contentType:"application/x-www-form-urlencoded",success:function(e){if(!e.result)return tips.show(e.message);window.location.href="index.html"},error:function(){tips.show("登录失败")}})):($("#kaptcha").focus(),tips.show("验证码不能为空")):($("#password").focus(),tips.show("密码不能为空")):($("#username").focus(),tips.show("用户名不能为空"))}$(function(){if($("#noRem").show(),aptchaClick(),void 0!==ischeck&&null!=ischeck&&"true"==ischeck){var e=window.localStorage.inputUsername,o=window.localStorage.inputPassword;$("#username").val(e),$("#password").val(o),$("#remImg").show(),$("#noRem").hide()}$(".login-form #kaptcha").keyup(function(){var e=$("#kaptcha").val().trim();4===e.length?aptchaChecked===e?($(".login-form .fa-check-circle-o").removeClass("hidden"),$(".login-form .fa-times-circle-o").addClass("hidden"),$(".login-form .login-btn").removeClass("disabled").removeAttr("disabled")):checkAptcha():($(".login-form .fa-check-circle-o").addClass("hidden"),$(".login-form .fa-times-circle-o").addClass("hidden"),$(".login-form .login-btn").addClass("disabled").attr("disabled","disabled"))}),$("#loginForm").submit(function(e){e.preventDefault(),login()})}),$("#remember").click(function(){ischeck?(localStorage.removeItem("inputPassword"),window.localStorage.remember=!1,ischeck=!1,$("#remImg").hide(),$("#noRem").show()):(ischeck=!0,$("#remImg").show(),$("#noRem").hide())});var tips={show:function(e){$("#tipCont").text(e),$(".error-tips").show(100)},hide:function(){$(".error-tips").hide()}};